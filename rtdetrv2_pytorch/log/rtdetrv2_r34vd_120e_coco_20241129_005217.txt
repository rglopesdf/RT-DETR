Not init distributed mode.
cfg:  {'task': 'detection', '_model': None, '_postprocessor': None, '_criterion': None, '_optimizer': None, '_lr_scheduler': None, '_lr_warmup_scheduler': None, '_train_dataloader': None, '_val_dataloader': None, '_ema': None, '_scaler': None, '_train_dataset': None, '_val_dataset': None, '_collate_fn': None, '_evaluator': None, '_writer': None, 'num_workers': 0, 'batch_size': None, '_train_batch_size': None, '_val_batch_size': None, '_train_shuffle': None, '_val_shuffle': None, 'resume': None, 'tuning': None, 'epoches': 200, 'last_epoch': -1, 'use_amp': True, 'use_ema': True, 'ema_decay': 0.9999, 'ema_warmups': 2000, 'sync_bn': True, 'clip_max_norm': 0.1, 'find_unused_parameters': False, 'seed': None, 'print_freq': 100, 'checkpoint_freq': 1, 'output_dir': './output/rtdetrv2_r34vd_120e_coco', 'summary_dir': None, 'device': '', 'yaml_cfg': {'task': 'detection', 'evaluator': {'type': 'CocoEvaluator', 'iou_types': ['bbox']}, 'num_classes': 1, 'remap_mscoco_category': False, 'train_dataloader': {'type': 'DataLoader', 'dataset': {'type': 'CocoDetection', 'img_folder': '../dataset/images/train/', 'ann_file': '../dataset/annotations/instances_train.json', 'return_masks': False, 'transforms': {'type': 'Compose', 'ops': [{'type': 'RandomPhotometricDistort', 'p': 0.5}, {'type': 'RandomZoomOut', 'fill': 0}, {'type': 'RandomIoUCrop', 'p': 0.8}, {'type': 'SanitizeBoundingBoxes', 'min_size': 1}, {'type': 'RandomHorizontalFlip'}, {'type': 'Resize', 'size': [640, 640]}, {'type': 'SanitizeBoundingBoxes', 'min_size': 1}, {'type': 'ConvertPILImage', 'dtype': 'float32', 'scale': True}, {'type': 'ConvertBoxes', 'fmt': 'cxcywh', 'normalize': True}], 'policy': {'name': 'stop_epoch', 'epoch': 1, 'ops': ['RandomPhotometricDistort', 'RandomZoomOut', 'RandomIoUCrop']}}}, 'shuffle': True, 'num_workers': 4, 'drop_last': True, 'collate_fn': {'type': 'BatchImageCollateFuncion', 'scales': [480, 512, 544, 576, 608, 640, 640, 640, 672, 704, 736, 768, 800], 'stop_epoch': 71}, 'total_batch_size': 16}, 'val_dataloader': {'type': 'DataLoader', 'dataset': {'type': 'CocoDetection', 'img_folder': '../dataset/images/val/', 'ann_file': '../dataset/annotations/instances_val.json', 'return_masks': False, 'transforms': {'type': 'Compose', 'ops': [{'type': 'Resize', 'size': [640, 640]}, {'type': 'ConvertPILImage', 'dtype': 'float32', 'scale': True}]}}, 'shuffle': False, 'num_workers': 4, 'drop_last': False, 'collate_fn': {'type': 'BatchImageCollateFuncion'}, 'total_batch_size': 16}, 'test_dataloader': {'type': 'DataLoader', 'dataset': {'type': 'CocoDetection', 'img_folder': '../dataset/images/test/', 'ann_file': '../dataset/annotations/instances_test.json', 'return_masks': False, 'transforms': {'type': 'Compose', 'ops': [{'type': 'Resize', 'size': [640, 640]}, {'type': 'ConvertPILImage', 'dtype': 'float32', 'scale': True}]}}, 'shuffle': False, 'num_workers': 4, 'drop_last': False, 'collate_fn': {'type': 'BatchImageCollateFuncion'}, 'total_batch_size': 16}, 'print_freq': 100, 'output_dir': './output/rtdetrv2_r34vd_120e_coco', 'checkpoint_freq': 1, 'sync_bn': True, 'find_unused_parameters': False, 'use_amp': True, 'scaler': {'type': 'GradScaler', 'enabled': True}, 'use_ema': True, 'ema': {'type': 'ModelEMA', 'decay': 0.9999, 'warmups': 2000}, 'epoches': 200, 'clip_max_norm': 0.1, 'optimizer': {'type': 'AdamW', 'params': [{'params': '^(?=.*backbone)(?!.*norm|bn).*$', 'lr': 5e-05}, {'params': '^(?=.*backbone)(?=.*norm|bn).*$', 'lr': 5e-05, 'weight_decay': 0.0}, {'params': '^(?=.*(?:encoder|decoder))(?=.*(?:norm|bn|bias)).*$', 'weight_decay': 0.0}], 'lr': 0.0001, 'betas': [0.9, 0.999], 'weight_decay': 0.0001}, 'lr_scheduler': {'type': 'MultiStepLR', 'milestones': [1000], 'gamma': 0.1}, 'lr_warmup_scheduler': {'type': 'LinearWarmup', 'warmup_duration': 2000}, 'model': 'RTDETR', 'criterion': 'RTDETRCriterionv2', 'postprocessor': 'RTDETRPostProcessor', 'use_focal_loss': True, 'eval_spatial_size': [640, 640], 'RTDETR': {'backbone': 'PResNet', 'encoder': 'HybridEncoder', 'decoder': 'RTDETRTransformerv2'}, 'PResNet': {'depth': 34, 'variant': 'd', 'freeze_at': -1, 'return_idx': [1, 2, 3], 'num_stages': 4, 'freeze_norm': False, 'pretrained': True}, 'HybridEncoder': {'in_channels': [128, 256, 512], 'feat_strides': [8, 16, 32], 'hidden_dim': 256, 'use_encoder_idx': [2], 'num_encoder_layers': 1, 'nhead': 8, 'dim_feedforward': 1024, 'dropout': 0.0, 'enc_act': 'gelu', 'expansion': 0.5, 'depth_mult': 1, 'act': 'silu'}, 'RTDETRTransformerv2': {'feat_channels': [256, 256, 256], 'feat_strides': [8, 16, 32], 'hidden_dim': 256, 'num_levels': 3, 'num_layers': 4, 'num_queries': 300, 'num_denoising': 100, 'label_noise_ratio': 0.5, 'box_noise_scale': 1.0, 'eval_idx': -1, 'num_points': [4, 4, 4], 'cross_attn_method': 'default', 'query_select_method': 'default'}, 'RTDETRPostProcessor': {'num_top_queries': 300}, 'RTDETRCriterionv2': {'weight_dict': {'loss_vfl': 1, 'loss_bbox': 5, 'loss_giou': 2}, 'losses': ['vfl', 'boxes'], 'alpha': 0.75, 'gamma': 2.0, 'matcher': {'type': 'HungarianMatcher', 'weight_dict': {'cost_class': 2, 'cost_bbox': 5, 'cost_giou': 2}, 'alpha': 0.25, 'gamma': 2.0}}, '__include__': ['../dataset/coco_detection.yml', '../runtime.yml', './include/dataloader.yml', './include/optimizer.yml', './include/rtdetrv2_r50vd.yml'], 'config': 'configs/rtdetrv2/rtdetrv2_r34vd_120e_coco.yml', 'test_only': False, 'print_method': 'builtin', 'print_rank': 0}}
Start training
Load PResNet34 state_dict
Initial lr: [5e-05, 5e-05, 0.0001, 0.0001]
building train_dataloader with batch_size=16...
loading annotations into memory...
Done (t=0.01s)
creating index...
index created!
building val_dataloader with batch_size=16...
loading annotations into memory...
Done (t=0.00s)
creating index...
index created!
number of trainable parameters: 31319929
Epoch: [0]  [0/8]  eta: 0:00:57  lr: 0.000000  loss: 24.0023 (24.0023)  loss_vfl: 0.5522 (0.5522)  loss_bbox: 0.6295 (0.6295)  loss_giou: 1.5586 (1.5586)  loss_vfl_aux_0: 0.5562 (0.5562)  loss_bbox_aux_0: 0.6215 (0.6215)  loss_giou_aux_0: 1.5692 (1.5692)  loss_vfl_aux_1: 0.5586 (0.5586)  loss_bbox_aux_1: 0.6353 (0.6353)  loss_giou_aux_1: 1.5424 (1.5424)  loss_vfl_aux_2: 0.5762 (0.5762)  loss_bbox_aux_2: 0.6117 (0.6117)  loss_giou_aux_2: 1.5346 (1.5346)  loss_vfl_dn_0: 0.7788 (0.7788)  loss_bbox_dn_0: 0.4214 (0.4214)  loss_giou_dn_0: 1.3624 (1.3624)  loss_vfl_dn_1: 0.8706 (0.8706)  loss_bbox_dn_1: 0.4214 (0.4214)  loss_giou_dn_1: 1.3624 (1.3624)  loss_vfl_dn_2: 0.8311 (0.8311)  loss_bbox_dn_2: 0.4214 (0.4214)  loss_giou_dn_2: 1.3624 (1.3624)  loss_vfl_dn_3: 0.8765 (0.8765)  loss_bbox_dn_3: 0.4214 (0.4214)  loss_giou_dn_3: 1.3624 (1.3624)  loss_vfl_enc_0: 0.4282 (0.4282)  loss_bbox_enc_0: 0.6052 (0.6052)  loss_giou_enc_0: 1.5306 (1.5306)  time: 7.1441  data: 2.1219  max mem: 7976
Epoch: [0]  [7/8]  eta: 0:00:01  lr: 0.000000  loss: 23.6298 (23.7565)  loss_vfl: 0.5332 (0.5343)  loss_bbox: 0.5737 (0.5862)  loss_giou: 1.5739 (1.5865)  loss_vfl_aux_0: 0.5410 (0.5409)  loss_bbox_aux_0: 0.5968 (0.6015)  loss_giou_aux_0: 1.5834 (1.5886)  loss_vfl_aux_1: 0.5391 (0.5300)  loss_bbox_aux_1: 0.5982 (0.6072)  loss_giou_aux_1: 1.5716 (1.5817)  loss_vfl_aux_2: 0.5410 (0.5435)  loss_bbox_aux_2: 0.5851 (0.5845)  loss_giou_aux_2: 1.5705 (1.5780)  loss_vfl_dn_0: 0.7686 (0.7698)  loss_bbox_dn_0: 0.3969 (0.3897)  loss_giou_dn_0: 1.3624 (1.3642)  loss_vfl_dn_1: 0.8569 (0.8577)  loss_bbox_dn_1: 0.3969 (0.3897)  loss_giou_dn_1: 1.3624 (1.3642)  loss_vfl_dn_2: 0.8169 (0.8306)  loss_bbox_dn_2: 0.3969 (0.3897)  loss_giou_dn_2: 1.3624 (1.3642)  loss_vfl_dn_3: 0.8584 (0.8677)  loss_bbox_dn_3: 0.3969 (0.3897)  loss_giou_dn_3: 1.3624 (1.3642)  loss_vfl_enc_0: 0.4204 (0.4143)  loss_bbox_enc_0: 0.5711 (0.5845)  loss_giou_enc_0: 1.5413 (1.5536)  time: 1.6750  data: 0.2823  max mem: 10049
Epoch: [0] Total time: 0:00:13 (1.6812 s / it)
Averaged stats: lr: 0.000000  loss: 23.6298 (23.7565)  loss_vfl: 0.5332 (0.5343)  loss_bbox: 0.5737 (0.5862)  loss_giou: 1.5739 (1.5865)  loss_vfl_aux_0: 0.5410 (0.5409)  loss_bbox_aux_0: 0.5968 (0.6015)  loss_giou_aux_0: 1.5834 (1.5886)  loss_vfl_aux_1: 0.5391 (0.5300)  loss_bbox_aux_1: 0.5982 (0.6072)  loss_giou_aux_1: 1.5716 (1.5817)  loss_vfl_aux_2: 0.5410 (0.5435)  loss_bbox_aux_2: 0.5851 (0.5845)  loss_giou_aux_2: 1.5705 (1.5780)  loss_vfl_dn_0: 0.7686 (0.7698)  loss_bbox_dn_0: 0.3969 (0.3897)  loss_giou_dn_0: 1.3624 (1.3642)  loss_vfl_dn_1: 0.8569 (0.8577)  loss_bbox_dn_1: 0.3969 (0.3897)  loss_giou_dn_1: 1.3624 (1.3642)  loss_vfl_dn_2: 0.8169 (0.8306)  loss_bbox_dn_2: 0.3969 (0.3897)  loss_giou_dn_2: 1.3624 (1.3642)  loss_vfl_dn_3: 0.8584 (0.8677)  loss_bbox_dn_3: 0.3969 (0.3897)  loss_giou_dn_3: 1.3624 (1.3642)  loss_vfl_enc_0: 0.4204 (0.4143)  loss_bbox_enc_0: 0.5711 (0.5845)  loss_giou_enc_0: 1.5413 (1.5536)
Test:  [0/3]  eta: 0:00:05    time: 1.7479  data: 0.7716  max mem: 10049
Test:  [2/3]  eta: 0:00:01    time: 1.1672  data: 0.2817  max mem: 10049
Test: Total time: 0:00:03 (1.1841 s / it)
Averaged stats: 
Accumulating evaluation results...
DONE (t=0.05s).
IoU metric: bbox
 Average Precision  (AP) @[ IoU=0.50:0.95 | area=   all | maxDets=100 ] = 0.000
 Average Precision  (AP) @[ IoU=0.50      | area=   all | maxDets=100 ] = 0.000
 Average Precision  (AP) @[ IoU=0.75      | area=   all | maxDets=100 ] = 0.000
 Average Precision  (AP) @[ IoU=0.50:0.95 | area= small | maxDets=100 ] = 0.000
 Average Precision  (AP) @[ IoU=0.50:0.95 | area=medium | maxDets=100 ] = 0.003
 Average Precision  (AP) @[ IoU=0.50:0.95 | area= large | maxDets=100 ] = 0.000
 Average Recall     (AR) @[ IoU=0.50:0.95 | area=   all | maxDets=  1 ] = 0.000
 Average Recall     (AR) @[ IoU=0.50:0.95 | area=   all | maxDets= 10 ] = 0.000
 Average Recall     (AR) @[ IoU=0.50:0.95 | area=   all | maxDets=100 ] = 0.002
 Average Recall     (AR) @[ IoU=0.50:0.95 | area= small | maxDets=100 ] = 0.006
 Average Recall     (AR) @[ IoU=0.50:0.95 | area=medium | maxDets=100 ] = 0.001
 Average Recall     (AR) @[ IoU=0.50:0.95 | area= large | maxDets=100 ] = 0.000
best_stat: {'epoch': 0, 'coco_eval_bbox': 3.405623791846211e-05}
Epoch: [1]  [0/8]  eta: 0:00:15  lr: 0.000000  loss: 24.8491 (24.8491)  loss_vfl: 0.3997 (0.3997)  loss_bbox: 0.7212 (0.7212)  loss_giou: 1.7218 (1.7218)  loss_vfl_aux_0: 0.4163 (0.4163)  loss_bbox_aux_0: 0.7243 (0.7243)  loss_giou_aux_0: 1.7421 (1.7421)  loss_vfl_aux_1: 0.3782 (0.3782)  loss_bbox_aux_1: 0.7215 (0.7215)  loss_giou_aux_1: 1.7182 (1.7182)  loss_vfl_aux_2: 0.4465 (0.4465)  loss_bbox_aux_2: 0.7288 (0.7288)  loss_giou_aux_2: 1.7098 (1.7098)  loss_vfl_dn_0: 0.7427 (0.7427)  loss_bbox_dn_0: 0.5130 (0.5130)  loss_giou_dn_0: 1.3472 (1.3472)  loss_vfl_dn_1: 0.8169 (0.8169)  loss_bbox_dn_1: 0.5130 (0.5130)  loss_giou_dn_1: 1.3472 (1.3472)  loss_vfl_dn_2: 0.8462 (0.8462)  loss_bbox_dn_2: 0.5130 (0.5130)  loss_giou_dn_2: 1.3472 (1.3472)  loss_vfl_dn_3: 0.8506 (0.8506)  loss_bbox_dn_3: 0.5130 (0.5130)  loss_giou_dn_3: 1.3472 (1.3472)  loss_vfl_enc_0: 0.3157 (0.3157)  loss_bbox_enc_0: 0.7112 (0.7112)  loss_giou_enc_0: 1.6971 (1.6971)  time: 1.9914  data: 0.9950  max mem: 10049
Epoch: [1]  [7/8]  eta: 0:00:01  lr: 0.000000  loss: 24.7426 (24.7024)  loss_vfl: 0.3997 (0.3976)  loss_bbox: 0.6943 (0.6996)  loss_giou: 1.7218 (1.7179)  loss_vfl_aux_0: 0.4014 (0.4065)  loss_bbox_aux_0: 0.7040 (0.7108)  loss_giou_aux_0: 1.7374 (1.7335)  loss_vfl_aux_1: 0.3782 (0.3758)  loss_bbox_aux_1: 0.7088 (0.7057)  loss_giou_aux_1: 1.7182 (1.7255)  loss_vfl_aux_2: 0.4438 (0.4448)  loss_bbox_aux_2: 0.6926 (0.7008)  loss_giou_aux_2: 1.7146 (1.7192)  loss_vfl_dn_0: 0.7427 (0.7529)  loss_bbox_dn_0: 0.4895 (0.4959)  loss_giou_dn_0: 1.3472 (1.3472)  loss_vfl_dn_1: 0.8188 (0.8304)  loss_bbox_dn_1: 0.4895 (0.4959)  loss_giou_dn_1: 1.3472 (1.3472)  loss_vfl_dn_2: 0.8462 (0.8561)  loss_bbox_dn_2: 0.4895 (0.4959)  loss_giou_dn_2: 1.3472 (1.3472)  loss_vfl_dn_3: 0.8442 (0.8513)  loss_bbox_dn_3: 0.4895 (0.4959)  loss_giou_dn_3: 1.3472 (1.3472)  loss_vfl_enc_0: 0.3157 (0.3143)  loss_bbox_enc_0: 0.6837 (0.6920)  loss_giou_enc_0: 1.6971 (1.6954)  time: 1.0471  data: 0.1583  max mem: 10049
Epoch: [1] Total time: 0:00:08 (1.0531 s / it)
Averaged stats: lr: 0.000000  loss: 24.7426 (24.7024)  loss_vfl: 0.3997 (0.3976)  loss_bbox: 0.6943 (0.6996)  loss_giou: 1.7218 (1.7179)  loss_vfl_aux_0: 0.4014 (0.4065)  loss_bbox_aux_0: 0.7040 (0.7108)  loss_giou_aux_0: 1.7374 (1.7335)  loss_vfl_aux_1: 0.3782 (0.3758)  loss_bbox_aux_1: 0.7088 (0.7057)  loss_giou_aux_1: 1.7182 (1.7255)  loss_vfl_aux_2: 0.4438 (0.4448)  loss_bbox_aux_2: 0.6926 (0.7008)  loss_giou_aux_2: 1.7146 (1.7192)  loss_vfl_dn_0: 0.7427 (0.7529)  loss_bbox_dn_0: 0.4895 (0.4959)  loss_giou_dn_0: 1.3472 (1.3472)  loss_vfl_dn_1: 0.8188 (0.8304)  loss_bbox_dn_1: 0.4895 (0.4959)  loss_giou_dn_1: 1.3472 (1.3472)  loss_vfl_dn_2: 0.8462 (0.8561)  loss_bbox_dn_2: 0.4895 (0.4959)  loss_giou_dn_2: 1.3472 (1.3472)  loss_vfl_dn_3: 0.8442 (0.8513)  loss_bbox_dn_3: 0.4895 (0.4959)  loss_giou_dn_3: 1.3472 (1.3472)  loss_vfl_enc_0: 0.3157 (0.3143)  loss_bbox_enc_0: 0.6837 (0.6920)  loss_giou_enc_0: 1.6971 (1.6954)
Test:  [0/3]  eta: 0:00:05    time: 1.7837  data: 0.8642  max mem: 10049
Test:  [2/3]  eta: 0:00:01    time: 1.0589  data: 0.2990  max mem: 10049
Test: Total time: 0:00:03 (1.0763 s / it)
Averaged stats: 
Accumulating evaluation results...
DONE (t=0.04s).
IoU metric: bbox
 Average Precision  (AP) @[ IoU=0.50:0.95 | area=   all | maxDets=100 ] = 0.000
 Average Precision  (AP) @[ IoU=0.50      | area=   all | maxDets=100 ] = 0.000
 Average Precision  (AP) @[ IoU=0.75      | area=   all | maxDets=100 ] = 0.000
 Average Precision  (AP) @[ IoU=0.50:0.95 | area= small | maxDets=100 ] = 0.000
 Average Precision  (AP) @[ IoU=0.50:0.95 | area=medium | maxDets=100 ] = 0.002
 Average Precision  (AP) @[ IoU=0.50:0.95 | area= large | maxDets=100 ] = 0.000
 Average Recall     (AR) @[ IoU=0.50:0.95 | area=   all | maxDets=  1 ] = 0.000
 Average Recall     (AR) @[ IoU=0.50:0.95 | area=   all | maxDets= 10 ] = 0.000
 Average Recall     (AR) @[ IoU=0.50:0.95 | area=   all | maxDets=100 ] = 0.003
 Average Recall     (AR) @[ IoU=0.50:0.95 | area= small | maxDets=100 ] = 0.004
 Average Recall     (AR) @[ IoU=0.50:0.95 | area=medium | maxDets=100 ] = 0.001
 Average Recall     (AR) @[ IoU=0.50:0.95 | area= large | maxDets=100 ] = 0.019
best_stat: {'epoch': 0, 'coco_eval_bbox': 3.405623791846211e-05}
Epoch: [2]  [0/8]  eta: 0:00:11  lr: 0.000000  loss: 24.3811 (24.3811)  loss_vfl: 0.4092 (0.4092)  loss_bbox: 0.6727 (0.6727)  loss_giou: 1.6918 (1.6918)  loss_vfl_aux_0: 0.4260 (0.4260)  loss_bbox_aux_0: 0.6666 (0.6666)  loss_giou_aux_0: 1.7141 (1.7141)  loss_vfl_aux_1: 0.3906 (0.3906)  loss_bbox_aux_1: 0.6753 (0.6753)  loss_giou_aux_1: 1.7133 (1.7133)  loss_vfl_aux_2: 0.4575 (0.4575)  loss_bbox_aux_2: 0.6684 (0.6684)  loss_giou_aux_2: 1.6953 (1.6953)  loss_vfl_dn_0: 0.7119 (0.7119)  loss_bbox_dn_0: 0.4817 (0.4817)  loss_giou_dn_0: 1.3680 (1.3680)  loss_vfl_dn_1: 0.7871 (0.7871)  loss_bbox_dn_1: 0.4817 (0.4817)  loss_giou_dn_1: 1.3680 (1.3680)  loss_vfl_dn_2: 0.8174 (0.8174)  loss_bbox_dn_2: 0.4817 (0.4817)  loss_giou_dn_2: 1.3680 (1.3680)  loss_vfl_dn_3: 0.8003 (0.8003)  loss_bbox_dn_3: 0.4817 (0.4817)  loss_giou_dn_3: 1.3680 (1.3680)  loss_vfl_enc_0: 0.3401 (0.3401)  loss_bbox_enc_0: 0.6774 (0.6774)  loss_giou_enc_0: 1.6670 (1.6670)  time: 1.4925  data: 0.8618  max mem: 10049
